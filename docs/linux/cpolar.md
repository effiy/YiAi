# Cpolar 内网穿透工具使用指南

> 作者：YiAi  
> 日期：2024 年 6 月

## 背景

### 内网穿透的概念

在计算机网络中，内网（局域网）通常无法直接被外网访问。这是因为：

1. 内网设备使用私有 IP 地址
2. 路由器/防火墙会阻止外部访问
3. 运营商可能会限制入站连接

内网穿透技术就是解决这个问题的方案，它通过建立一条从外网到内网的通道，使得外部网络可以访问到内网中的服务。

## 认知

### 作用

Cpolar 是一个强大的内网穿透工具，它能够将本地服务暴露到公网，让外部网络可以访问到内网中的服务。通过 Cpolar，你可以：

- 将本地开发环境暴露到公网
- 实现远程访问内网服务
- 进行微信开发调试
- 进行物联网设备远程控制
- 实现远程桌面访问

这些特性使 Cpolar 成为开发调试和远程访问的必备工具。

## 设计

### 命令说明表

| 功能类型     | 命令                                            | 说明                           |
| ------------ | ----------------------------------------------- | ------------------------------ |
| HTTP 服务    | `cpolar http 80`                                | 启动 HTTP 服务，端口 80        |
| TCP 服务     | `cpolar tcp 22`                                 | 启动 TCP 服务，端口 22         |
| HTTPS 服务   | `cpolar https 443`                              | 启动 HTTPS 服务，端口 443      |
| 自定义域名   | `cpolar http 80 --domain=your-domain.cpolar.cn` | 设置自定义域名，方便记忆和访问 |
| 多端口映射   | `cpolar http 80,443,8080`                       | 同时映射多个端口               |
| 访问密码     | `cpolar http 80 --auth="username:password"`     | 设置访问密码，增加安全性       |
| 查看版本信息 | `cpolar version`                                | 查看当前版本信息               |
| 查看所有隧道 | `cpolar list`                                   | 查看所有活动的隧道             |
| 查看服务状态 | `cpolar status`                                 | 查看当前服务运行状态           |
| 停止服务     | `cpolar stop`                                   | 停止所有运行中的服务           |

## 实践

### 本地开发调试

将本地开发服务器暴露到公网，方便远程调试：

```bash
# 假设本地开发服务器运行在 3000 端口
cpolar http 3000
```

### 远程桌面访问

通过 TCP 协议映射远程桌面端口：

```bash
# Windows 远程桌面默认端口 3389
cpolar tcp 3389
```

### 物联网设备控制

将物联网设备的控制端口映射到公网：

```bash
# 假设设备控制端口为 8080
cpolar tcp 8080
```

## 改进

### 注意事项

1. 免费版本有连接数和带宽限制
2. 建议使用 HTTPS 协议保证安全性
3. 不要将 authtoken 泄露给他人
4. 及时更新到最新版本
5. 遵守服务条款和法律法规

### 常见问题

#### 连接失败

可能的原因：

- authtoken 配置错误
- 网络连接问题
- 端口被占用

#### 速度慢

可能的解决方案：

- 选择更近的服务器节点
- 检查本地网络状况
- 升级到付费版本

## 七、参考链接

- [Cpolar 官方网站](https://www.cpolar.com)
- [Cpolar 文档中心](https://www.cpolar.com/docs)
- [Cpolar GitHub 仓库](https://github.com/cpolar/cpolar)
